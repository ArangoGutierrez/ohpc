--- vnfs/libexec/wwmkchroot/functions	2015-08-26 19:58:46.000000000 -0700
+++ vnfs.patch/libexec/wwmkchroot/functions	2016-02-23 12:06:26.546334700 -0800
@@ -117,7 +117,11 @@
 }
 
 configure_authentication() {
-    /usr/sbin/chroot $CHROOTDIR /usr/sbin/pwconv
+    if [ -x "/usr/sbin/chroot" ]; then
+        /usr/sbin/chroot $CHROOTDIR /usr/sbin/pwconv
+    elif [ -x "/usr/bin/chroot" ]; then
+       /usr/bin/chroot $CHROOTDIR /usr/sbin/pwconv
+    fi
     return 0
 }
 
@@ -189,7 +193,9 @@
 }
 
 configure_network() {
-    if [ -d $CHROOTDIR/etc/sysconfig ]; then
+    if [ -d $CHROOTDIR/etc/sysconfig/network ]; then
+        return 0
+    elif [ -d $CHROOTDIR/etc/sysconfig ]; then
         echo "NETWORKING=yes" > $CHROOTDIR/etc/sysconfig/network
     fi
     return 0
--- vnfs/libexec/wwmkchroot/golden-system.tmpl	2013-08-07 20:29:18.000000000 -0700
+++ vnfs.patch/libexec/wwmkchroot/golden-system.tmpl	2016-02-23 12:07:08.447213200 -0800
@@ -36,6 +36,7 @@
         --exclude=/var/tmp/* \
         --exclude=/var/log/* \
         --exclude=/var/run/* \
+        --exclude=/var/lib/ntp/* \
         root@$SOURCEADDR:/ .
 
     if [ $? -ne 0 ]; then
--- /dev/null	2016-03-04 09:47:19.000000000 -0800
+++ vnfs.patch/libexec/wwmkchroot/opensuse-13.tmpl	2016-02-23 13:38:58.416584700 -0800
@@ -0,0 +1,20 @@
+# The general SUSE include has all of the necessary functions, but requires
+# some basic variables specific to each chroot type to be defined.
+. include-suse
+
+
+
+# Define the location of the YUM repository
+ZYP_MIRROR="http://download.opensuse.org/update/13.1/x86_64/"
+
+# Install only what is necessary/specific for this distribution
+PKGLIST="sysvinit aaa_base bash openSUSE-release coreutils e2fsprogs ethtool \
+    filesystem findutils gawk grep iproute2 iputils mingetty net-tools \
+    nfs-kernel-server pam rpcbind procps psmisc rdate rsync sed shadow rsyslog tcpd \
+    timezone util-linux words libz1 tar less gzip which module-init-tools \
+    udev openssh dhcp-client pciutils vim strace cronie cpufrequtils cpio wget"
+
+
+
+
+# vim:filetype=sh:syntax=sh:expandtab:ts=4:sw=4:
--- /dev/null	2016-03-04 11:17:29.000000000 -0800
+++ vnfs.patch/libexec/wwmkchroot/include-suse	2016-03-04 11:16:19.597987500 -0800
@@ -0,0 +1,105 @@
+REPO_NAME="SLES12-12-0-sp1"
+ZYP_CONF="/root/yum-ww.conf"
+ZYP_CMD="zypper -c $CHROOTDIR/$ZYP_CONF --root $CHROOTDIR -n --gpg-auto-import-keys"
+
+distro_check() {
+    if ! rpm -q zypper >/dev/null 2>&1 ; then
+        echo "ERROR: Could not query RPM for Zypper"
+        return 1
+    fi
+    return 0
+}
+
+set_overlay() {
+    if [ ! -d "$CHROOTDIR" -o ! -x "$CHROOTDIR/sbin/init" ]; then
+        echo "ERROR: This is an overlay that must work on an existing chroot!"
+        return 1
+    fi
+    if [ ! -f "$CHROOTDIR/etc/SuSE-release" ]; then
+        echo "ERROR: This must be a SuSE compatible chroot!"
+        return 1
+    fi
+    PKGR_CMD="$ZYP_CMD install $PKGLIST"
+    return 0
+}
+
+prechroot() {
+    if [ -n "$OS_MIRROR" ]; then
+        ZYP_MIRROR="$OS_MIRROR"
+    fi
+    if [[ -z "$ZYP_MIRROR" && -z "$INSTALL_ISO" ]]; then
+        echo "ERROR: You must define the \$ZYP_MIRROR variable in the template"
+        cleanup
+        return 1
+    fi
+
+    VERSION=`rpm -qf /etc/SuSE-release  --qf '%{VERSION}\n'`
+
+    mkdir -p $CHROOTDIR
+    mkdir -p $CHROOTDIR/etc
+    mkdir -p $CHROOTDIR/etc/zypp
+    mkdir -p $CHROOTDIR/dev
+
+    cp -rap /etc/zypp/zypper.conf /etc/zypp/repos.d $CHROOTDIR/etc
+    sed -i -e "s/\$releasever/$VERSION/g" `find $CHROOTDIR/etc/zypp* -type f`
+
+    ZYP_CONF_DIRNAME=`dirname $ZYP_CONF`
+    mkdir -m 0755 -p $CHROOTDIR/$ZYP_CONF_DIRNAME
+
+    > $CHROOTDIR/$ZYP_CONF
+    echo "[main]" >> $CHROOTDIR/$ZYP_CONF
+    echo '#cachedir=/var/cache/yum/$basearch/$releasever' >> $CHROOTDIR/$ZYP_CONF
+    echo "#keepcache=0" >> $CHROOTDIR/$ZYP_CONF
+    echo "#debuglevel=2" >> $CHROOTDIR/$ZYP_CONF
+    echo "#logfile=/var/log/yum.log" >> $CHROOTDIR/$ZYP_CONF
+    echo "#exactarch=1" >> $CHROOTDIR/$ZYP_CONF
+    echo "#obsoletes=1" >> $CHROOTDIR/$ZYP_CONF
+    echo "#gpgcheck=0" >> $CHROOTDIR/$ZYP_CONF
+    echo "#plugins=1" >> $CHROOTDIR/$ZYP_CONF
+    echo "#reposdir=0" >> $CHROOTDIR/$ZYP_CONF
+    echo "" >> $CHROOTDIR/$ZYP_CONF
+
+    cp -RLp /dev/zero $CHROOTSDIR/.
+
+    if [ -z "$INSTALL_ISO" ]; then
+        echo "[$REPO_NAME]" >> $CHROOTDIR/$ZYP_CONF
+        echo 'name=Linux $releasever - $basearch' >> $CHROOTDIR/$ZYP_CONF
+        echo "baseurl=$ZYP_MIRROR" >> $CHROOTDIR/$ZYP_CONF
+        echo "enabled=1" >> $CHROOTDIR/$ZYP_CONF
+        echo "type=rpm-md" >> $CHROOTDIR/$ZYP_CONF
+        echo "gpgcheck=0" >> $CHROOTDIR/$ZYP_CONF
+    else
+        for i in `ls -d $MEDIA_MOUNTPATH.*`; do
+            if [ -z "$INSTALLDIRS" ]; then
+                if [ -d $i/repodata ]; then
+                    # RHEL 6.x
+                    INSTALLDIRS="file://$i"
+                elif [ -d $i/Server/repodata ]; then
+                    # RHEL 5.x
+                    INSTALLDIRS="file://$i/Server"
+                fi
+            else
+                INSTALLDIRS="$INSTALLDIRS,file://$i"
+            fi
+        done
+        echo "[$REPO_NAME]" >> $CHROOTDIR/$ZYP_CONF
+        echo 'name=Linux $releasever - $basearch' >> $CHROOTDIR/$ZYP_CONF
+        echo "baseurl=$INSTALLDIRS" >> $CHROOTDIR/$ZYP_CONF
+        echo "enabled=1" >> $CHROOTDIR/$ZYP_CONF
+        echo "type=rpm-md" >> $CHROOTDIR/$ZYP_CONF
+        echo "gpgcheck=0" >> $CHROOTDIR/$ZYP_CONF
+
+        ZYP_MIRROR=$INSTALLDIRS
+    fi
+
+    PKGR_CMD="$ZYP_CMD install $PKGLIST"
+    return 0
+}
+
+postchroot() {
+    touch $CHROOTDIR/fastboot
+    return 0
+}
+
+
+# vim:filetype=sh:syntax=sh:expandtab:ts=4:sw=4:
--- /dev/null	2016-03-04 11:17:53.000000000 -0800
+++ vnfs.patch/libexec/wwmkchroot/sles-11.tmpl	2016-02-23 13:35:39.753360000 -0800
@@ -0,0 +1,22 @@
+#DESC: SUSE Linux Enterprise 11SP3
+
+# The general SUSE include has all of the necessary functions, but requires
+# some basic variables specific to each chroot type to be defined.
+. include-suse
+
+
+
+# Define the location of the Zypper repository
+ZYP_MIRROR="SUSE-url"
+
+# Install only what is necessary/specific for this distribution
+PKGLIST="sysvinit aaa_base bash sles-release coreutils e2fsprogs ethtool \
+    filesystem findutils gawk grep iproute2 iputils mingetty net-tools \
+    nfs-kernel-server pam rpcbind procps psmisc pwdutils rsync sed rsyslog tcpd \
+    timezone util-linux words zlib tar less gzip module-init-tools \
+    udev openssh dhcp-client pciutils vim strace cron cpufrequtils cpio wget zypper libstdc++6 libgcc_s1"
+
+
+
+
+# vim:filetype=sh:syntax=sh:expandtab:ts=4:sw=4:
--- /dev/null	2016-03-04 11:17:57.000000000 -0800
+++ vnfs.patch/libexec/wwmkchroot/sles-12.tmpl	2016-02-23 13:35:39.760361400 -0800
@@ -0,0 +1,22 @@
+#DESC: SUSE Linux Enterprise 12
+
+# The general SUSE include has all of the necessary functions, but requires
+# some basic variables specific to each chroot type to be defined.
+. include-suse
+
+
+
+# Define the location of the Zypper repository
+ZYP_MIRROR="SUSE-url"
+
+# Install only what is necessary/specific for this distribution
+PKGLIST="systemd-sysvinit aaa_base bash dracut sles-release coreutils e2fsprogs ethtool \
+    filesystem findutils gawk grep iproute2 iputils mingetty net-tools \
+    nfs-kernel-server pam rpcbind procps psmisc shadow rsync sed rsyslog tcpd \
+    timezone util-linux words libz1 tar less gzip kmod-compat udev openssh \
+    dhcp-client pciutils vim strace cron cpupower cpio wget zypper libstdc++6 libgcc_s1"
+
+
+
+
+# vim:filetype=sh:syntax=sh:expandtab:ts=4:sw=4:
--- vnfs/libexec/wwmkchroot/Makefile.am	2016-02-15 20:36:06.000000000 -0800
+++ vnfs.patch/libexec/wwmkchroot/Makefile.am	2016-03-04 11:20:01.473853800 -0800
@@ -1,6 +1,7 @@
 wwmkchrootdir = $(libexecdir)/warewulf/wwmkchroot
 
-dist_wwmkchroot_SCRIPTS = centos-5.tmpl centos-6.tmpl centos-7.tmpl include-rhel rhel-generic.tmpl sl-5.tmpl sl-6.tmpl sl-7.tmpl functions include-deb debian-8.tmpl debian7-32.tmpl debian7-64.tmpl golden-system.tmpl
+dist_wwmkchroot_SCRIPTS = centos-5.tmpl centos-6.tmpl centos-7.tmpl include-rhel rhel-generic.tmpl sl-5.tmpl sl-6.tmpl sl-7.tmpl functions include-deb debian-8.tmpl debian7-32.tmpl debian7-64.tmpl golden-system.tmpl include-suse opensuse-13.tmpl sles-11.tmpl sles-12.tmpl
+ 
 
 MAINTAINERCLEANFILES = Makefile.in
 
--- vnfs/bin/wwbootstrap	2015-08-06 15:24:06.000000000 -0700
+++ vnfs.patch/bin/wwbootstrap	2016-03-04 11:23:42.121974600 -0800
@@ -239,6 +239,11 @@
 
     }
 
+    # manually copy modules.order and modules.builtin from chroot to
+    # suppress warning from depmod
+    copy("$opt_chroot/lib/modules/$opt_kversion/modules.order", "$tmpdir/initramfs/lib/modules/$opt_kversion/modules.order");
+    copy("$opt_chroot/lib/modules/$opt_kversion/modules.builtin", "$tmpdir/initramfs/lib/modules/$opt_kversion/modules.builtin");
+
     if ($module_count > 0) {
         &nprint("Number of drivers included in bootstrap: $module_count\n");
         &dprint("Running depmod\n");
